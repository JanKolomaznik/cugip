<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CUGIP: /home/johny/programming/git/MedV4D/extern/cugip/include/cugip/basic_filters/watershed_transformation.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CUGIP
   </div>
   <div id="projectbrief">CUDA Generic Image Processing</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('watershed__transformation_8hpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">watershed_transformation.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="watershed__transformation_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="math_8hpp.html">cugip/math.hpp</a>&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="traits_8hpp.html">cugip/traits.hpp</a>&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="transform_8hpp.html">cugip/transform.hpp</a>&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="filter_8hpp.html">cugip/filter.hpp</a>&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="device__flag_8hpp.html">cugip/device_flag.hpp</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="access__utils_8hpp.html">cugip/access_utils.hpp</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="connected__component__labeling_8hpp.html">cugip/basic_filters/connected_component_labeling.hpp</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacecugip.html">cugip</a> {</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">namespace detail {</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">template&lt;typename TInputType, typename TLUT&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">struct scan_neighborhood_for_steepest_descent_ftor</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">{</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">      scan_neighborhood_for_steepest_descent_ftor(TLUT aLUT, device_flag_view aLutUpdatedFlag)</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">            : mLUT(aLUT), mLutUpdatedFlag(aLutUpdatedFlag)</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">      {}</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">      template&lt;typename TLocator&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">      CUGIP_DECL_HYBRID TInputType</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">      minValidLabel(TLocator aLocator, TInputType aCurrent, const dimension_2d_tag &amp;)</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">      {</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">            TInputType minimum = aCurrent;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">            for (int j = -1; j &lt;= 1; ++j) {</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">                  for (int i = -1; i &lt;= 1; ++i) {</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">                        TInputType value = aLocator[typename TLocator::diff_t(i, j)];</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">                        minimum = (value &lt; minimum &amp;&amp; value &gt; 0) ? value : minimum;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">                  }</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">            }</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">            return minimum;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">      template&lt;typename TLocator&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">      CUGIP_DECL_DEVICE void // TODO hybrid</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">      operator()(TLocator aLocator)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">      {</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">            TInputType current = aLocator.get();</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">            if (0 &lt; current) {</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">                  TInputType minLabel = minValidLabel(aLocator, current, typename dimension&lt;TLocator&gt;::type());;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">                  if (minLabel &lt; mLUT[current-1]) {</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">                        //printf(&quot;%d - %d - %d; &quot;, current, mLUT[current-1], minLabel);</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">                        mLUT[current-1] = minLabel;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">                        mLutUpdatedFlag.set_device();</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">                  }</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">            }</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">      TLUT mLUT;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">      device_flag_view mLutUpdatedFlag;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">};</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">template &lt;typename TImageView, typename TLUTBufferView&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">void</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">scan_image_for_steepest_descent_ftor(TImageView aImageView, TLUTBufferView aLUT, device_flag_view aLutUpdatedFlag)</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">{</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">      for_each_locator(aImageView, scan_neighborhood_for_connections_ftor&lt;typename TImageView::value_type, TLUTBufferView&gt;(aLUT, aLutUpdatedFlag));</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">}//namespace detail</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">template &lt;typename TImageView, typename TIdImageView, typename TLUTBufferView&gt;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">void</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">watershed_transformation(TImageView aImageView, TIdImageView, TLUTBufferView aLUT)</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">{</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">      device_flag lutUpdatedFlag;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">      lutUpdatedFlag.reset_host();</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">      D_PRINT(&quot;Watershed transform initialization ...&quot;);</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">      detail::init_lut(aImageView, aLUT);</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">      detail::scan_image(aImageView, aLUT, lutUpdatedFlag.view());</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">      int i = 0;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">      while (lutUpdatedFlag.check_host()) {</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">            D_PRINT(&quot;    Running WShed iteration ...&quot; &lt;&lt; ++i);</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">            lutUpdatedFlag.reset_host();</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">            detail::update_lut(aImageView, aLUT);</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">            detail::update_labels(aImageView, aLUT);</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">            detail::scan_image(aImageView, aLUT, lutUpdatedFlag.view());</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">      D_PRINT(&quot;Watershed transform done!&quot;);</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//*****************************************************************************************</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//template &lt;typename TImageView, typename TIdImageView,&gt;</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structcugip_1_1step1__ftor.html">   94</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcugip_1_1step1__ftor.html">step1_ftor</a></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TImageLocator, <span class="keyword">typename</span> TIdLocator&gt;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="defines_8hpp.html#a0748bb6d3c82ac1f9e42d04650b9fc36">CUGIP_DECL_DEVICE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structcugip_1_1step1__ftor.html#afc2125232c86f53ecc2ed93285018aba">   98</a></span>&#160;      <a class="code" href="structcugip_1_1step1__ftor.html#afc2125232c86f53ecc2ed93285018aba">operator()</a>(TImageLocator aImageLocator, TIdLocator aIdLocator)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keyword">typename</span> TImageLocator::value_type currentMin = aImageLocator.get();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">bool</span> lowerExists = <span class="keyword">false</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keyword">typename</span> TImageLocator::diff_t offset;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = -1; j &lt;= 1; ++j) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = -1; i &lt;= 1; ++i) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        <span class="keyword">typename</span> TImageLocator::value_type value = aImageLocator[<span class="keyword">typename</span> TImageLocator::diff_t(i, j)];</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                        <span class="keywordflow">if</span> (value &lt; currentMin) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                              lowerExists = <span class="keyword">true</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                              currentMin = value;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                              offset = <span class="keyword">typename</span> TImageLocator::diff_t(i, j);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                  }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">if</span> (lowerExists) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                  aIdLocator.get() = -aIdLocator[offset];</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                  aIdLocator.get() = 0; <span class="comment">//Plateau</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;};</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView&gt;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="namespacecugip.html#a28e96dfc7f81b7704ed911822567c7ca">  124</a></span>&#160;<a class="code" href="namespacecugip.html#a28e96dfc7f81b7704ed911822567c7ca">step1</a>(TImageView aImageView, TIdImageView aIdImageView)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      for_each_locator(aImageView, aIdImageView, <a class="code" href="structcugip_1_1step1__ftor.html">step1_ftor</a>());</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView&gt;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="namespacecugip.html#a3408392afedc28e42033f9675f8f03e9">  131</a></span>&#160;<a class="code" href="namespacecugip.html#a3408392afedc28e42033f9675f8f03e9">step2</a>(TImageView aImageView, TIdImageView aIdImageView)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">//for_each_locator(aImageView, aIdImageView, step1_ftor());</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView&gt;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="namespacecugip.html#a679e7091ea74c7c312713d494fa01177">  138</a></span>&#160;<a class="code" href="namespacecugip.html#a679e7091ea74c7c312713d494fa01177">step3</a>(TImageView aImageView, TIdImageView aIdImageView)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">//for_each_locator(aImageView, aIdImageView, step1_ftor());</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView&gt;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="namespacecugip.html#a9eddd610052730f009c424b347327c08">  145</a></span>&#160;<a class="code" href="namespacecugip.html#a9eddd610052730f009c424b347327c08">step4</a>(TImageView aImageView, TIdImageView aIdImageView)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="comment">//for_each_locator(aImageView, aIdImageView, step1_ftor());</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView&gt;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="namespacecugip.html#aea028e29632e4dce5de0efa8633b6fbc">  153</a></span>&#160;<a class="code" href="namespacecugip.html#aea028e29632e4dce5de0efa8633b6fbc">watershed_transformation</a>(TImageView aImageView, TIdImageView aIdImageView, TIdImageView aTmpIdImageView)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="namespacecugip.html#a28e96dfc7f81b7704ed911822567c7ca">step1</a>(aImageView, aIdImageView);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="namespacecugip.html#a3408392afedc28e42033f9675f8f03e9">step2</a>(aImageView, aIdImageView, aTmpIdImageView);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <a class="code" href="namespacecugip.html#a679e7091ea74c7c312713d494fa01177">step3</a>(aImageView, aIdImageView);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="namespacecugip.html#a9eddd610052730f009c424b347327c08">step4</a>(aImageView, aIdImageView);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">//**************************************************</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> TLabel, <span class="keyword">typename</span> TDistance&gt;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structcugip_1_1init__wsheds__ftor.html">  162</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcugip_1_1init__wsheds__ftor.html">init_wsheds_ftor</a></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structcugip_1_1init__wsheds__ftor.html#a33cbd07ec00187b3db2b0cf69a24c25b">  164</a></span>&#160;      <a class="code" href="structcugip_1_1init__wsheds__ftor.html#a33cbd07ec00187b3db2b0cf69a24c25b">init_wsheds_ftor</a>(TDistance aInfinity)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            : infinity(aInfinity)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      {}</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="defines_8hpp.html#a9467ae046da1c6ac51763cd91fe791d9">CUGIP_DECL_HYBRID</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structcugip_1_1init__wsheds__ftor.html#a86a89ffa05425b407a06b80c914801a3">  169</a></span>&#160;      <a class="code" href="structcugip_1_1init__wsheds__ftor.html#a86a89ffa05425b407a06b80c914801a3">operator()</a>(<span class="keyword">const</span> TLabel &amp;aLabel, TDistance &amp;aDistance)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            aDistance = aLabel == 0 ? infinity : 0;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structcugip_1_1init__wsheds__ftor.html#ae2d6e90b764253dae4059f0079e40504">  174</a></span>&#160;      TDistance <a class="code" href="structcugip_1_1init__wsheds__ftor.html#ae2d6e90b764253dae4059f0079e40504">infinity</a>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;};</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TDistanceView&gt;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespacecugip.html#a6bd8cf34d01fe1f7311a3dc30f5f374f">  179</a></span>&#160;<a class="code" href="namespacecugip.html#a6bd8cf34d01fe1f7311a3dc30f5f374f">init_watershed_buffers</a>(TIdImageView aIdImageView, TDistanceView aDistanceView)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="group__meta__algorithm.html#ga5b5057c3753b24eebffa1825efe3d781">for_each</a>(</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            aIdImageView,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            aDistanceView,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="structcugip_1_1init__wsheds__ftor.html">init_wsheds_ftor&lt;typename TIdImageView::value_type, typename TDistanceView::value_type&gt;</a>(65000)); <span class="comment">//TODO</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">//**************************************************</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TDistanceView&gt;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<a class="code" href="defines_8hpp.html#a3622623c13b0ac33495d50526cb56ed6">CUGIP_GLOBAL</a> <span class="keywordtype">void</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="namespacecugip.html#a263038d5a02afed94c997437492be4c1">  189</a></span>&#160;<a class="code" href="namespacecugip.html#a263038d5a02afed94c997437492be4c1">watershed_evolution_kernel</a>(</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            TImageView aImageView,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            TIdImageView aIdImageView,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            TIdImageView aTmpIdImageView,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            TDistanceView aDistanceView1,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            TDistanceView aDistanceView2,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="structcugip_1_1device__flag__view.html">device_flag_view</a> aUpdateFlag)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> TImageView::value_type Value;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> TIdImageView::value_type Label;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="classcugip_1_1image__locator.html">image_locator&lt;TIdImageView, cugip::border_handling_repeat_t&gt;</a> LabelLocator;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="classcugip_1_1image__locator.html">image_locator&lt;TDistanceView, cugip::border_handling_repeat_t&gt;</a> DistanceLocator;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> TDistanceView::value_type Distance;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keyword">typename</span> TImageView::coord_t coord(blockIdx.x * blockDim.x + threadIdx.x, blockIdx.y * blockDim.y + threadIdx.y);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keyword">typename</span> TImageView::extents_t extents = aImageView.dimensions();</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">if</span> (coord &lt; extents) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            Value value = aImageView[coord];</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            DistanceLocator distanceLocator = aDistanceView1.template locator&lt;cugip::border_handling_repeat_t&gt;(coord);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            Distance currentDistance = distanceLocator.get();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            LabelLocator labelLocator = aIdImageView.template locator&lt;cugip::border_handling_repeat_t&gt;(coord);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            Label label = labelLocator.get();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            Distance currentMinimum = <a class="code" href="namespacecugip.html#a109891c654e30ed29fe3cc2d294e570e">max</a>(0, currentDistance - value);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keyword">typename</span> DistanceLocator::diff_t offset;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = -1; j &lt;= 1; ++j) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = -1; i &lt;= 1; ++i) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        Distance distance = distanceLocator[<span class="keyword">typename</span> DistanceLocator::diff_t(i, j)];</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        <span class="keywordflow">if</span> (distance &lt; currentMinimum) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                              currentMinimum = distance;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                              offset = <span class="keyword">typename</span> DistanceLocator::diff_t(i, j);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                              found = <span class="keyword">true</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                  aUpdateFlag.<a class="code" href="structcugip_1_1device__flag__view.html#a9723e55b22d1d553a238db21d4c66702">set_device</a>();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                  currentDistance = currentMinimum + value;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                  label = labelLocator[offset];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            aDistanceView2[coord] = currentDistance;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            aTmpIdImageView[coord] = label;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TDistanceView&gt;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="namespacecugip.html#af58a34fb71fba403affb54ed6ea65eb3">  239</a></span>&#160;<a class="code" href="namespacecugip.html#af58a34fb71fba403affb54ed6ea65eb3">watershed_evolution</a>(</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            TImageView aImageView,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            TIdImageView aIdImageView,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            TIdImageView aTmpIdImageView,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            TDistanceView aDistanceView1,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            TDistanceView aDistanceView2,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="structcugip_1_1device__flag__view.html">device_flag_view</a> aUpdateFlag)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      dim3 blockSize(256, 1, 1);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      dim3 gridSize((aImageView.dimensions().template get&lt;0&gt;() / blockSize.x + 1), aImageView.dimensions().template get&lt;1&gt;() / blockSize.y + 1, 1);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      watershed_evolution_kernel&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        aImageView,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        aIdImageView,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                        aTmpIdImageView,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                        aDistanceView1,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                        aDistanceView2,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        aUpdateFlag);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TDistanceView&gt;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="namespacecugip.html#a90d49745eeee3ac20835e37fdbe24ad8">  262</a></span>&#160;<a class="code" href="namespacecugip.html#a90d49745eeee3ac20835e37fdbe24ad8">watershed_transformation2</a>(</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            TImageView aImageView,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            TIdImageView aIdImageView,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            TIdImageView aTmpIdImageView,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            TDistanceView aDistanceView1,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            TDistanceView aDistanceView2</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            )</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="structcugip_1_1device__flag.html">device_flag</a> updatedFlag;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      updatedFlag.<a class="code" href="structcugip_1_1device__flag__view.html#a804ac8addcc08d62069207009c41b746">reset_host</a>();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="include_8hpp.html#ace640b60065aafdf307cfa900ce55ba9">D_PRINT</a>(<span class="stringliteral">&quot;    Init WSHED computation ...&quot;</span>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="namespacecugip.html#a6bd8cf34d01fe1f7311a3dc30f5f374f">init_watershed_buffers</a>(aIdImageView, aDistanceView1);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">do</span> {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <a class="code" href="include_8hpp.html#ace640b60065aafdf307cfa900ce55ba9">D_PRINT</a>(<span class="stringliteral">&quot;    Running WSHED iteration ...&quot;</span> &lt;&lt; ++i);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            updatedFlag.<a class="code" href="structcugip_1_1device__flag__view.html#a804ac8addcc08d62069207009c41b746">reset_host</a>();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="namespacecugip.html#af58a34fb71fba403affb54ed6ea65eb3">watershed_evolution</a>(</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        aImageView,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                        aIdImageView,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                        aTmpIdImageView,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        aDistanceView1,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        aDistanceView2,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        updatedFlag.<a class="code" href="structcugip_1_1device__flag.html#adec75697a785b0a948f222d00b7bdecd">view</a>());</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            std::swap(aTmpIdImageView, aIdImageView);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            std::swap(aDistanceView1, aDistanceView2);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="comment">//TODO handle copying after last iteration</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      } <span class="keywordflow">while</span> (updatedFlag.<a class="code" href="structcugip_1_1device__flag__view.html#ae91c324b4ae2f64111808627c9f70910">check_host</a>());</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">//==================================================================================</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//**************************************************</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> TUnionFind, <span class="keyword">typename</span> TExtents&gt;</div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__ftor.html">  296</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcugip_1_1init__watershed__labels__ftor.html">init_watershed_labels_ftor</a></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__ftor.html#a3ec0d9d4b458d9460643c2189fa95463">  298</a></span>&#160;      <a class="code" href="structcugip_1_1init__watershed__labels__ftor.html#a3ec0d9d4b458d9460643c2189fa95463">init_watershed_labels_ftor</a>(TUnionFind aUnionFind, TExtents aExtents)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            : unionFind(aUnionFind)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            , extents(aExtents)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      {}</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TLabel, <span class="keyword">typename</span> TCoordinates&gt;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="defines_8hpp.html#a9467ae046da1c6ac51763cd91fe791d9">CUGIP_DECL_HYBRID</a> TLabel</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__ftor.html#a08a3f63efd2f2d114d55ebc515be5e25">  305</a></span>&#160;      <a class="code" href="structcugip_1_1init__watershed__labels__ftor.html#a08a3f63efd2f2d114d55ebc515be5e25">operator()</a>(<span class="keyword">const</span> TLabel &amp;aLabel, <span class="keyword">const</span> TCoordinates &amp;aCoords)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            TLabel label = 1 + <a class="code" href="namespacecugip.html#a47ea03fa3d5d724160ddcac6f0be7a4b">get_linear_access_index</a>(extents, aCoords);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            unionFind.set(label, label);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">return</span> label;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__ftor.html#ac7446f36dee20b132652edbce2c0cf88">  312</a></span>&#160;      TUnionFind <a class="code" href="structcugip_1_1init__watershed__labels__ftor.html#ac7446f36dee20b132652edbce2c0cf88">unionFind</a>;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__ftor.html#a958e35bb6027e7e282b852294fc550ae">  313</a></span>&#160;      TExtents <a class="code" href="structcugip_1_1init__watershed__labels__ftor.html#a958e35bb6027e7e282b852294fc550ae">extents</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;};</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TUnionFind&gt;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="namespacecugip.html#a8a80962f32914c3e82410f390dcc2969">  318</a></span>&#160;<a class="code" href="namespacecugip.html#a8a80962f32914c3e82410f390dcc2969">init_watershed_labels</a>(TIdImageView aIdImageView, TUnionFind aUnionFind)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="group__meta__algorithm.html#gaed8ea8380bdd7755722b1508a95eedb1">for_each_position</a>(</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            aIdImageView,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <a class="code" href="structcugip_1_1init__watershed__labels__ftor.html">init_watershed_labels_ftor&lt;TUnionFind, typename TIdImageView::extents_t&gt;</a>(aUnionFind, aIdImageView.dimensions())</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            );</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">//**************************************************</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> TUnionFind, <span class="keyword">typename</span> TExtents&gt;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html">  328</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html">init_watershed_labels_from_plateaus_ftor</a></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#abc4948e41f286089339bd8bd641c17c9">  330</a></span>&#160;      <a class="code" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#abc4948e41f286089339bd8bd641c17c9">init_watershed_labels_from_plateaus_ftor</a>(TUnionFind aUnionFind, TExtents aExtents)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            : unionFind(aUnionFind)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            , extents(aExtents)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      {}</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TLabel, <span class="keyword">typename</span> TCoordinates&gt;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="defines_8hpp.html#a9467ae046da1c6ac51763cd91fe791d9">CUGIP_DECL_HYBRID</a> TLabel</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#affc6468576f4985bd155720e3d89c164">  337</a></span>&#160;      <a class="code" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#affc6468576f4985bd155720e3d89c164">operator()</a>(<span class="keyword">const</span> TLabel &amp;aLabel, <span class="keyword">const</span> TCoordinates &amp;aCoords)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">if</span> (aLabel != 0) {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                  <span class="keywordflow">return</span> aLabel;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            TLabel label = 1 + <a class="code" href="namespacecugip.html#a47ea03fa3d5d724160ddcac6f0be7a4b">get_linear_access_index</a>(extents, aCoords);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            unionFind.set(label, label);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">return</span> label;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#a598fcea3cd0171b9bc812a0bfc885d43">  347</a></span>&#160;      TUnionFind <a class="code" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#a598fcea3cd0171b9bc812a0bfc885d43">unionFind</a>;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#a5e2fd023d4fc17f06b276abe34ee99bb">  348</a></span>&#160;      TExtents <a class="code" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#a5e2fd023d4fc17f06b276abe34ee99bb">extents</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;};</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TUnionFind&gt;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="namespacecugip.html#aac1fc4b51b3d99ee4f2a9a6474ce1c38">  353</a></span>&#160;<a class="code" href="namespacecugip.html#aac1fc4b51b3d99ee4f2a9a6474ce1c38">init_watershed_from_plateaus_labels</a>(TIdImageView aIdImageView, TUnionFind aUnionFind)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <a class="code" href="group__meta__algorithm.html#gaed8ea8380bdd7755722b1508a95eedb1">for_each_position</a>(</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            aIdImageView,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <a class="code" href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html">init_watershed_labels_from_plateaus_ftor&lt;TUnionFind, typename TIdImageView::extents_t&gt;</a>(aUnionFind, aIdImageView.dimensions())</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            );</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> TUnionFind&gt;</div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="structcugip_1_1scan__image__for__wshed__path__ftor.html">  366</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcugip_1_1scan__image__for__wshed__path__ftor.html">scan_image_for_wshed_path_ftor</a></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;{</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#abfb8be8332e0dddc53b6ba3eff085bb3">  368</a></span>&#160;      <a class="code" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#abfb8be8332e0dddc53b6ba3eff085bb3">scan_image_for_wshed_path_ftor</a>(TUnionFind aUnionFind, <a class="code" href="structcugip_1_1device__flag__view.html">device_flag_view</a> aUpdatedFlag)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            : mUnionFind(aUnionFind)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            , mUpdatedFlag(aUpdatedFlag)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      {}</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TImageLocator, <span class="keyword">typename</span> TLabelImageLocator&gt;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="defines_8hpp.html#a0748bb6d3c82ac1f9e42d04650b9fc36">CUGIP_DECL_DEVICE</a> <span class="keywordtype">void</span> <span class="comment">// TODO hybrid</span></div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#ab9106b1a4e751e2f34fee810fd1555ad">  375</a></span>&#160;      <a class="code" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#ab9106b1a4e751e2f34fee810fd1555ad">operator()</a>(TImageLocator aImageLocator, TLabelImageLocator aLabelLocator)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keyword">typedef</span> <span class="keyword">typename</span> TImageLocator::value_type Value;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keyword">typedef</span> <span class="keyword">typename</span> TLabelImageLocator::value_type Label;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            Value current = aImageLocator.get();</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            Value minimum = current;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keyword">typename</span> TImageLocator::diff_t offset;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordtype">bool</span> hasBigger = <span class="keyword">false</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="comment">//bool isPlateau = true;</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            Label currentLabel = aLabelLocator.get();</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordtype">bool</span> print = (aImageLocator.coords()[0] == 133) &amp;&amp; (aImageLocator.coords()[1] == 32);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="comment">//    Label plateauLabel = aLabelLocator[typename TLabelImageLocator::diff_t(-1, -1)];</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = -1; j &lt;= 1; ++j) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = -1; i &lt;= 1; ++i) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        Value value = aImageLocator[<span class="keyword">typename</span> TImageLocator::diff_t(i, j)];</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        <span class="keywordflow">if</span> (value &gt; current) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                              hasBigger = <span class="keyword">true</span>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        <span class="comment">/*if (value != current) {</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">                              isPlateau = false;*/</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                              <span class="keywordflow">if</span> (value &lt;= minimum &amp;&amp; i != 0 &amp;&amp; j != 0<span class="comment">/* || hasBigger &amp;&amp; value == minimum*/</span>) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                    minimum = value;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                    found = <span class="keyword">true</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                    offset = <span class="keyword">typename</span> TImageLocator::diff_t(i, j);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                              }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="keywordflow">if</span> (print) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                              printf(<span class="stringliteral">&quot;%d, %d, label = %d, val = %d; h = %d; o = %d %d \n&quot;</span>, i, j, <span class="keywordtype">int</span>(aLabelLocator[<span class="keyword">typename</span> TImageLocator::diff_t(i, j)]), <span class="keywordtype">int</span>(value), <span class="keywordtype">int</span>(hasBigger), offset[0], offset[1]);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  <span class="comment">/*    } else {</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">                              plateauLabel = min(plateauLabel, aLabelLocator[typename TImageLocator::diff_t(i, j)]);</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">                        }*/</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                  }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment">/*if (isPlateau) {</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">                  Label minLabel = min(plateauLabel, currentLabel);</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">                  Label maxLabel = max(plateauLabel, currentLabel);</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">                  if (minLabel &lt; mUnionFind.get(currentLabel)) {</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">                        mUnionFind.set(currentLabel, minLabel);</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">                        mUpdatedFlag.set_device();</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">                  }</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">            } else {*/</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                  <span class="keywordflow">if</span> (found &amp;&amp; (minimum &lt; current || hasBigger)) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        Label lowerLabel = aLabelLocator[offset];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        Label minLabel = <a class="code" href="namespacecugip.html#a0875bcce375b87a954a5080d5c1ce650">min</a>(lowerLabel, currentLabel);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        Label maxLabel = <a class="code" href="namespacecugip.html#a109891c654e30ed29fe3cc2d294e570e">max</a>(lowerLabel, currentLabel);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        <span class="keywordflow">if</span> (minLabel &lt; mUnionFind.get(maxLabel)) {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                              mUnionFind.set(maxLabel, minLabel);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                              mUpdatedFlag.set_device();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                  }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#addf2a9350f81ea0ac7c859885628803a">  430</a></span>&#160;      TUnionFind <a class="code" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#addf2a9350f81ea0ac7c859885628803a">mUnionFind</a>;</div><div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#a7c9e7353cefe82c6d189e6aea58bc771">  431</a></span>&#160;      <a class="code" href="structcugip_1_1device__flag__view.html">device_flag_view</a> <a class="code" href="structcugip_1_1scan__image__for__wshed__path__ftor.html#a7c9e7353cefe82c6d189e6aea58bc771">mUpdatedFlag</a>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;};</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TUnionFind&gt;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="namespacecugip.html#a5d4979d143141d6a5781e2cc96b426f0">  437</a></span>&#160;<a class="code" href="namespacecugip.html#a5d4979d143141d6a5781e2cc96b426f0">scan_image_for_wshed_path</a>(</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            TImageView aImageView,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            TIdImageView aIdImageView,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            TUnionFind aUnionFind,</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <a class="code" href="structcugip_1_1device__flag__view.html">device_flag_view</a> aUpdatedFlag)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      for_each_locator(</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            aImageView,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            aIdImageView,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <a class="code" href="structcugip_1_1scan__image__for__wshed__path__ftor.html">scan_image_for_wshed_path_ftor&lt;TUnionFind&gt;</a>(aUnionFind, aUpdatedFlag));</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;}</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TImageView, <span class="keyword">typename</span> TIdImageView, <span class="keyword">typename</span> TUnionFind&gt;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="namespacecugip.html#af83da7b2df5b1040408a8c68088a949c">  452</a></span>&#160;<a class="code" href="namespacecugip.html#af83da7b2df5b1040408a8c68088a949c">watershed_transformation1</a>(</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            TImageView aImageView,</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            TIdImageView aIdImageView,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            TUnionFind aUnionFind</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            )</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="structcugip_1_1device__flag.html">device_flag</a> updatedFlag;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      updatedFlag.<a class="code" href="structcugip_1_1device__flag__view.html#a804ac8addcc08d62069207009c41b746">reset_host</a>();</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <a class="code" href="include_8hpp.html#ace640b60065aafdf307cfa900ce55ba9">D_PRINT</a>(<span class="stringliteral">&quot;    Init WSHED computation ...&quot;</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="group__meta__algorithm.html#ga6aa918cf13250a4544a84903175b035e">filter</a>(aImageView, aIdImageView, <a class="code" href="structcugip_1_1local__minima__detection__ftor.html">local_minima_detection_ftor&lt;typename TIdImageView::value_type&gt;</a>());</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="namespacecugip.html#aa58255ddeb817222c3fceaeed87dbdac">connected_component_labeling</a>(aIdImageView, aUnionFind);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="namespacecugip.html#aac1fc4b51b3d99ee4f2a9a6474ce1c38">init_watershed_from_plateaus_labels</a>(aIdImageView, aUnionFind);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">//init_watershed_labels(aIdImageView, aUnionFind);</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="namespacecugip.html#a5d4979d143141d6a5781e2cc96b426f0">scan_image_for_wshed_path</a>(</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            aImageView,</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            aIdImageView,</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            aUnionFind,</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            updatedFlag.<a class="code" href="structcugip_1_1device__flag.html#adec75697a785b0a948f222d00b7bdecd">view</a>());</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">while</span> (updatedFlag.<a class="code" href="structcugip_1_1device__flag__view.html#ae91c324b4ae2f64111808627c9f70910">check_host</a>()) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <a class="code" href="include_8hpp.html#ace640b60065aafdf307cfa900ce55ba9">D_PRINT</a>(<span class="stringliteral">&quot;    Running WSHED iteration ...&quot;</span> &lt;&lt; ++i);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            updatedFlag.<a class="code" href="structcugip_1_1device__flag__view.html#a804ac8addcc08d62069207009c41b746">reset_host</a>();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            detail::update_lut(aIdImageView, aUnionFind);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            detail::update_labels(aIdImageView, aUnionFind);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <a class="code" href="namespacecugip.html#a5d4979d143141d6a5781e2cc96b426f0">scan_image_for_wshed_path</a>(</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                  aImageView,</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                  aIdImageView,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                  aUnionFind,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                  updatedFlag.<a class="code" href="structcugip_1_1device__flag.html#adec75697a785b0a948f222d00b7bdecd">view</a>());</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}<span class="comment">//namespace cugip</span></div><div class="ttc" id="defines_8hpp_html_a0748bb6d3c82ac1f9e42d04650b9fc36"><div class="ttname"><a href="defines_8hpp.html#a0748bb6d3c82ac1f9e42d04650b9fc36">CUGIP_DECL_DEVICE</a></div><div class="ttdeci">#define CUGIP_DECL_DEVICE</div><div class="ttdef"><b>Definition:</b> <a href="defines_8hpp_source.html#l00021">defines.hpp:21</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__from__plateaus__ftor_html_a5e2fd023d4fc17f06b276abe34ee99bb"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#a5e2fd023d4fc17f06b276abe34ee99bb">cugip::init_watershed_labels_from_plateaus_ftor::extents</a></div><div class="ttdeci">TExtents extents</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00348">watershed_transformation.hpp:348</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__ftor_html_a958e35bb6027e7e282b852294fc550ae"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__ftor.html#a958e35bb6027e7e282b852294fc550ae">cugip::init_watershed_labels_ftor::extents</a></div><div class="ttdeci">TExtents extents</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00313">watershed_transformation.hpp:313</a></div></div>
<div class="ttc" id="structcugip_1_1local__minima__detection__ftor_html"><div class="ttname"><a href="structcugip_1_1local__minima__detection__ftor.html">cugip::local_minima_detection_ftor</a></div><div class="ttdef"><b>Definition:</b> <a href="local__minima__detection_8hpp_source.html#l00014">local_minima_detection.hpp:14</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__from__plateaus__ftor_html"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html">cugip::init_watershed_labels_from_plateaus_ftor</a></div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00328">watershed_transformation.hpp:328</a></div></div>
<div class="ttc" id="namespacecugip_html_a90d49745eeee3ac20835e37fdbe24ad8"><div class="ttname"><a href="namespacecugip.html#a90d49745eeee3ac20835e37fdbe24ad8">cugip::watershed_transformation2</a></div><div class="ttdeci">void watershed_transformation2(TImageView aImageView, TIdImageView aIdImageView, TIdImageView aTmpIdImageView, TDistanceView aDistanceView1, TDistanceView aDistanceView2)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00262">watershed_transformation.hpp:262</a></div></div>
<div class="ttc" id="structcugip_1_1scan__image__for__wshed__path__ftor_html_addf2a9350f81ea0ac7c859885628803a"><div class="ttname"><a href="structcugip_1_1scan__image__for__wshed__path__ftor.html#addf2a9350f81ea0ac7c859885628803a">cugip::scan_image_for_wshed_path_ftor::mUnionFind</a></div><div class="ttdeci">TUnionFind mUnionFind</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00430">watershed_transformation.hpp:430</a></div></div>
<div class="ttc" id="structcugip_1_1device__flag__view_html_a804ac8addcc08d62069207009c41b746"><div class="ttname"><a href="structcugip_1_1device__flag__view.html#a804ac8addcc08d62069207009c41b746">cugip::device_flag_view::reset_host</a></div><div class="ttdeci">CUGIP_DECL_HOST void reset_host()</div><div class="ttdef"><b>Definition:</b> <a href="device__flag_8hpp_source.html#l00019">device_flag.hpp:19</a></div></div>
<div class="ttc" id="structcugip_1_1scan__image__for__wshed__path__ftor_html"><div class="ttname"><a href="structcugip_1_1scan__image__for__wshed__path__ftor.html">cugip::scan_image_for_wshed_path_ftor</a></div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00366">watershed_transformation.hpp:366</a></div></div>
<div class="ttc" id="structcugip_1_1device__flag__view_html"><div class="ttname"><a href="structcugip_1_1device__flag__view.html">cugip::device_flag_view</a></div><div class="ttdef"><b>Definition:</b> <a href="device__flag_8hpp_source.html#l00007">device_flag.hpp:7</a></div></div>
<div class="ttc" id="traits_8hpp_html"><div class="ttname"><a href="traits_8hpp.html">traits.hpp</a></div></div>
<div class="ttc" id="structcugip_1_1step1__ftor_html_afc2125232c86f53ecc2ed93285018aba"><div class="ttname"><a href="structcugip_1_1step1__ftor.html#afc2125232c86f53ecc2ed93285018aba">cugip::step1_ftor::operator()</a></div><div class="ttdeci">CUGIP_DECL_DEVICE void operator()(TImageLocator aImageLocator, TIdLocator aIdLocator)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00098">watershed_transformation.hpp:98</a></div></div>
<div class="ttc" id="structcugip_1_1init__wsheds__ftor_html_a86a89ffa05425b407a06b80c914801a3"><div class="ttname"><a href="structcugip_1_1init__wsheds__ftor.html#a86a89ffa05425b407a06b80c914801a3">cugip::init_wsheds_ftor::operator()</a></div><div class="ttdeci">CUGIP_DECL_HYBRID void operator()(const TLabel &amp;aLabel, TDistance &amp;aDistance)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00169">watershed_transformation.hpp:169</a></div></div>
<div class="ttc" id="structcugip_1_1init__wsheds__ftor_html"><div class="ttname"><a href="structcugip_1_1init__wsheds__ftor.html">cugip::init_wsheds_ftor</a></div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00162">watershed_transformation.hpp:162</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__ftor_html_a08a3f63efd2f2d114d55ebc515be5e25"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__ftor.html#a08a3f63efd2f2d114d55ebc515be5e25">cugip::init_watershed_labels_ftor::operator()</a></div><div class="ttdeci">CUGIP_DECL_HYBRID TLabel operator()(const TLabel &amp;aLabel, const TCoordinates &amp;aCoords)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00305">watershed_transformation.hpp:305</a></div></div>
<div class="ttc" id="namespacecugip_html_a263038d5a02afed94c997437492be4c1"><div class="ttname"><a href="namespacecugip.html#a263038d5a02afed94c997437492be4c1">cugip::watershed_evolution_kernel</a></div><div class="ttdeci">CUGIP_GLOBAL void watershed_evolution_kernel(TImageView aImageView, TIdImageView aIdImageView, TIdImageView aTmpIdImageView, TDistanceView aDistanceView1, TDistanceView aDistanceView2, device_flag_view aUpdateFlag)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00189">watershed_transformation.hpp:189</a></div></div>
<div class="ttc" id="structcugip_1_1init__wsheds__ftor_html_ae2d6e90b764253dae4059f0079e40504"><div class="ttname"><a href="structcugip_1_1init__wsheds__ftor.html#ae2d6e90b764253dae4059f0079e40504">cugip::init_wsheds_ftor::infinity</a></div><div class="ttdeci">TDistance infinity</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00174">watershed_transformation.hpp:174</a></div></div>
<div class="ttc" id="classcugip_1_1image__locator_html"><div class="ttname"><a href="classcugip_1_1image__locator.html">cugip::image_locator</a></div><div class="ttdef"><b>Definition:</b> <a href="image__locator_8hpp_source.html#l00135">image_locator.hpp:135</a></div></div>
<div class="ttc" id="structcugip_1_1init__wsheds__ftor_html_a33cbd07ec00187b3db2b0cf69a24c25b"><div class="ttname"><a href="structcugip_1_1init__wsheds__ftor.html#a33cbd07ec00187b3db2b0cf69a24c25b">cugip::init_wsheds_ftor::init_wsheds_ftor</a></div><div class="ttdeci">init_wsheds_ftor(TDistance aInfinity)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00164">watershed_transformation.hpp:164</a></div></div>
<div class="ttc" id="namespacecugip_html_aa58255ddeb817222c3fceaeed87dbdac"><div class="ttname"><a href="namespacecugip.html#aa58255ddeb817222c3fceaeed87dbdac">cugip::connected_component_labeling</a></div><div class="ttdeci">void connected_component_labeling(TImageView aImageView, TLUTBufferView aLUT)</div><div class="ttdef"><b>Definition:</b> <a href="connected__component__labeling_8hpp_source.html#l00162">connected_component_labeling.hpp:162</a></div></div>
<div class="ttc" id="namespacecugip_html_aea028e29632e4dce5de0efa8633b6fbc"><div class="ttname"><a href="namespacecugip.html#aea028e29632e4dce5de0efa8633b6fbc">cugip::watershed_transformation</a></div><div class="ttdeci">void watershed_transformation(TImageView aImageView, TIdImageView aIdImageView, TIdImageView aTmpIdImageView)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00153">watershed_transformation.hpp:153</a></div></div>
<div class="ttc" id="group__meta__algorithm_html_ga6aa918cf13250a4544a84903175b035e"><div class="ttname"><a href="group__meta__algorithm.html#ga6aa918cf13250a4544a84903175b035e">cugip::filter</a></div><div class="ttdeci">void filter(TInView aInView, TOutView aOutView, TFunctor aOperator)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8hpp_source.html#l00033">filter.hpp:33</a></div></div>
<div class="ttc" id="namespacecugip_html_a28e96dfc7f81b7704ed911822567c7ca"><div class="ttname"><a href="namespacecugip.html#a28e96dfc7f81b7704ed911822567c7ca">cugip::step1</a></div><div class="ttdeci">void step1(TImageView aImageView, TIdImageView aIdImageView)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00124">watershed_transformation.hpp:124</a></div></div>
<div class="ttc" id="namespacecugip_html_af83da7b2df5b1040408a8c68088a949c"><div class="ttname"><a href="namespacecugip.html#af83da7b2df5b1040408a8c68088a949c">cugip::watershed_transformation1</a></div><div class="ttdeci">void watershed_transformation1(TImageView aImageView, TIdImageView aIdImageView, TUnionFind aUnionFind)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00452">watershed_transformation.hpp:452</a></div></div>
<div class="ttc" id="structcugip_1_1scan__image__for__wshed__path__ftor_html_a7c9e7353cefe82c6d189e6aea58bc771"><div class="ttname"><a href="structcugip_1_1scan__image__for__wshed__path__ftor.html#a7c9e7353cefe82c6d189e6aea58bc771">cugip::scan_image_for_wshed_path_ftor::mUpdatedFlag</a></div><div class="ttdeci">device_flag_view mUpdatedFlag</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00431">watershed_transformation.hpp:431</a></div></div>
<div class="ttc" id="structcugip_1_1device__flag_html_adec75697a785b0a948f222d00b7bdecd"><div class="ttname"><a href="structcugip_1_1device__flag.html#adec75697a785b0a948f222d00b7bdecd">cugip::device_flag::view</a></div><div class="ttdeci">device_flag_view &amp; view()</div><div class="ttdef"><b>Definition:</b> <a href="device__flag_8hpp_source.html#l00098">device_flag.hpp:98</a></div></div>
<div class="ttc" id="math_8hpp_html"><div class="ttname"><a href="math_8hpp.html">math.hpp</a></div></div>
<div class="ttc" id="namespacecugip_html_a8a80962f32914c3e82410f390dcc2969"><div class="ttname"><a href="namespacecugip.html#a8a80962f32914c3e82410f390dcc2969">cugip::init_watershed_labels</a></div><div class="ttdeci">void init_watershed_labels(TIdImageView aIdImageView, TUnionFind aUnionFind)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00318">watershed_transformation.hpp:318</a></div></div>
<div class="ttc" id="structcugip_1_1scan__image__for__wshed__path__ftor_html_ab9106b1a4e751e2f34fee810fd1555ad"><div class="ttname"><a href="structcugip_1_1scan__image__for__wshed__path__ftor.html#ab9106b1a4e751e2f34fee810fd1555ad">cugip::scan_image_for_wshed_path_ftor::operator()</a></div><div class="ttdeci">CUGIP_DECL_DEVICE void operator()(TImageLocator aImageLocator, TLabelImageLocator aLabelLocator)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00375">watershed_transformation.hpp:375</a></div></div>
<div class="ttc" id="namespacecugip_html_a679e7091ea74c7c312713d494fa01177"><div class="ttname"><a href="namespacecugip.html#a679e7091ea74c7c312713d494fa01177">cugip::step3</a></div><div class="ttdeci">void step3(TImageView aImageView, TIdImageView aIdImageView)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00138">watershed_transformation.hpp:138</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__from__plateaus__ftor_html_affc6468576f4985bd155720e3d89c164"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#affc6468576f4985bd155720e3d89c164">cugip::init_watershed_labels_from_plateaus_ftor::operator()</a></div><div class="ttdeci">CUGIP_DECL_HYBRID TLabel operator()(const TLabel &amp;aLabel, const TCoordinates &amp;aCoords)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00337">watershed_transformation.hpp:337</a></div></div>
<div class="ttc" id="namespacecugip_html_a6bd8cf34d01fe1f7311a3dc30f5f374f"><div class="ttname"><a href="namespacecugip.html#a6bd8cf34d01fe1f7311a3dc30f5f374f">cugip::init_watershed_buffers</a></div><div class="ttdeci">void init_watershed_buffers(TIdImageView aIdImageView, TDistanceView aDistanceView)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00179">watershed_transformation.hpp:179</a></div></div>
<div class="ttc" id="group__meta__algorithm_html_gaed8ea8380bdd7755722b1508a95eedb1"><div class="ttname"><a href="group__meta__algorithm.html#gaed8ea8380bdd7755722b1508a95eedb1">cugip::for_each_position</a></div><div class="ttdeci">void for_each_position(TView aView, TFunctor aOperator, cudaStream_t aCudaStream=0)</div><div class="ttdef"><b>Definition:</b> <a href="for__each_8hpp_source.html#l00087">for_each.hpp:87</a></div></div>
<div class="ttc" id="namespacecugip_html_af58a34fb71fba403affb54ed6ea65eb3"><div class="ttname"><a href="namespacecugip.html#af58a34fb71fba403affb54ed6ea65eb3">cugip::watershed_evolution</a></div><div class="ttdeci">void watershed_evolution(TImageView aImageView, TIdImageView aIdImageView, TIdImageView aTmpIdImageView, TDistanceView aDistanceView1, TDistanceView aDistanceView2, device_flag_view aUpdateFlag)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00239">watershed_transformation.hpp:239</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__ftor_html_ac7446f36dee20b132652edbce2c0cf88"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__ftor.html#ac7446f36dee20b132652edbce2c0cf88">cugip::init_watershed_labels_ftor::unionFind</a></div><div class="ttdeci">TUnionFind unionFind</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00312">watershed_transformation.hpp:312</a></div></div>
<div class="ttc" id="namespacecugip_html_a47ea03fa3d5d724160ddcac6f0be7a4b"><div class="ttname"><a href="namespacecugip.html#a47ea03fa3d5d724160ddcac6f0be7a4b">cugip::get_linear_access_index</a></div><div class="ttdeci">CUGIP_DECL_HYBRID int get_linear_access_index(TExtents aExtents, TCoordinates aCoordinates)</div><div class="ttdef"><b>Definition:</b> <a href="access__utils_8hpp_source.html#l00079">access_utils.hpp:79</a></div></div>
<div class="ttc" id="namespacecugip_html_a9eddd610052730f009c424b347327c08"><div class="ttname"><a href="namespacecugip.html#a9eddd610052730f009c424b347327c08">cugip::step4</a></div><div class="ttdeci">void step4(TImageView aImageView, TIdImageView aIdImageView)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00145">watershed_transformation.hpp:145</a></div></div>
<div class="ttc" id="namespacecugip_html_a0875bcce375b87a954a5080d5c1ce650"><div class="ttname"><a href="namespacecugip.html#a0875bcce375b87a954a5080d5c1ce650">cugip::min</a></div><div class="ttdeci">CUGIP_DECL_HYBRID TType min(TType aValue1, TType aValue2)</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00658">math.hpp:658</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__ftor_html_a3ec0d9d4b458d9460643c2189fa95463"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__ftor.html#a3ec0d9d4b458d9460643c2189fa95463">cugip::init_watershed_labels_ftor::init_watershed_labels_ftor</a></div><div class="ttdeci">init_watershed_labels_ftor(TUnionFind aUnionFind, TExtents aExtents)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00298">watershed_transformation.hpp:298</a></div></div>
<div class="ttc" id="defines_8hpp_html_a3622623c13b0ac33495d50526cb56ed6"><div class="ttname"><a href="defines_8hpp.html#a3622623c13b0ac33495d50526cb56ed6">CUGIP_GLOBAL</a></div><div class="ttdeci">#define CUGIP_GLOBAL</div><div class="ttdef"><b>Definition:</b> <a href="defines_8hpp_source.html#l00023">defines.hpp:23</a></div></div>
<div class="ttc" id="access__utils_8hpp_html"><div class="ttname"><a href="access__utils_8hpp.html">access_utils.hpp</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__from__plateaus__ftor_html_a598fcea3cd0171b9bc812a0bfc885d43"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#a598fcea3cd0171b9bc812a0bfc885d43">cugip::init_watershed_labels_from_plateaus_ftor::unionFind</a></div><div class="ttdeci">TUnionFind unionFind</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00347">watershed_transformation.hpp:347</a></div></div>
<div class="ttc" id="namespacecugip_html"><div class="ttname"><a href="namespacecugip.html">cugip</a></div><div class="ttdef"><b>Definition:</b> <a href="access__utils_8hpp_source.html#l00006">access_utils.hpp:6</a></div></div>
<div class="ttc" id="transform_8hpp_html"><div class="ttname"><a href="transform_8hpp.html">transform.hpp</a></div></div>
<div class="ttc" id="namespacecugip_html_a3408392afedc28e42033f9675f8f03e9"><div class="ttname"><a href="namespacecugip.html#a3408392afedc28e42033f9675f8f03e9">cugip::step2</a></div><div class="ttdeci">void step2(TImageView aImageView, TIdImageView aIdImageView)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00131">watershed_transformation.hpp:131</a></div></div>
<div class="ttc" id="connected__component__labeling_8hpp_html"><div class="ttname"><a href="connected__component__labeling_8hpp.html">connected_component_labeling.hpp</a></div></div>
<div class="ttc" id="structcugip_1_1scan__image__for__wshed__path__ftor_html_abfb8be8332e0dddc53b6ba3eff085bb3"><div class="ttname"><a href="structcugip_1_1scan__image__for__wshed__path__ftor.html#abfb8be8332e0dddc53b6ba3eff085bb3">cugip::scan_image_for_wshed_path_ftor::scan_image_for_wshed_path_ftor</a></div><div class="ttdeci">scan_image_for_wshed_path_ftor(TUnionFind aUnionFind, device_flag_view aUpdatedFlag)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00368">watershed_transformation.hpp:368</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__ftor_html"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__ftor.html">cugip::init_watershed_labels_ftor</a></div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00296">watershed_transformation.hpp:296</a></div></div>
<div class="ttc" id="namespacecugip_html_aac1fc4b51b3d99ee4f2a9a6474ce1c38"><div class="ttname"><a href="namespacecugip.html#aac1fc4b51b3d99ee4f2a9a6474ce1c38">cugip::init_watershed_from_plateaus_labels</a></div><div class="ttdeci">void init_watershed_from_plateaus_labels(TIdImageView aIdImageView, TUnionFind aUnionFind)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00353">watershed_transformation.hpp:353</a></div></div>
<div class="ttc" id="include_8hpp_html_ace640b60065aafdf307cfa900ce55ba9"><div class="ttname"><a href="include_8hpp.html#ace640b60065aafdf307cfa900ce55ba9">D_PRINT</a></div><div class="ttdeci">#define D_PRINT(ARG)</div><div class="ttdef"><b>Definition:</b> <a href="include_8hpp_source.html#l00022">include.hpp:22</a></div></div>
<div class="ttc" id="namespacecugip_html_a109891c654e30ed29fe3cc2d294e570e"><div class="ttname"><a href="namespacecugip.html#a109891c654e30ed29fe3cc2d294e570e">cugip::max</a></div><div class="ttdeci">CUGIP_DECL_HYBRID TType max(TType aValue1, TType aValue2)</div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00642">math.hpp:642</a></div></div>
<div class="ttc" id="structcugip_1_1device__flag__view_html_ae91c324b4ae2f64111808627c9f70910"><div class="ttname"><a href="structcugip_1_1device__flag__view.html#ae91c324b4ae2f64111808627c9f70910">cugip::device_flag_view::check_host</a></div><div class="ttdeci">CUGIP_DECL_HOST bool check_host()</div><div class="ttdef"><b>Definition:</b> <a href="device__flag_8hpp_source.html#l00051">device_flag.hpp:51</a></div></div>
<div class="ttc" id="namespacecugip_html_a5d4979d143141d6a5781e2cc96b426f0"><div class="ttname"><a href="namespacecugip.html#a5d4979d143141d6a5781e2cc96b426f0">cugip::scan_image_for_wshed_path</a></div><div class="ttdeci">void scan_image_for_wshed_path(TImageView aImageView, TIdImageView aIdImageView, TUnionFind aUnionFind, device_flag_view aUpdatedFlag)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00437">watershed_transformation.hpp:437</a></div></div>
<div class="ttc" id="structcugip_1_1init__watershed__labels__from__plateaus__ftor_html_abc4948e41f286089339bd8bd641c17c9"><div class="ttname"><a href="structcugip_1_1init__watershed__labels__from__plateaus__ftor.html#abc4948e41f286089339bd8bd641c17c9">cugip::init_watershed_labels_from_plateaus_ftor::init_watershed_labels_from_plateaus_ftor</a></div><div class="ttdeci">init_watershed_labels_from_plateaus_ftor(TUnionFind aUnionFind, TExtents aExtents)</div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00330">watershed_transformation.hpp:330</a></div></div>
<div class="ttc" id="structcugip_1_1device__flag__view_html_a9723e55b22d1d553a238db21d4c66702"><div class="ttname"><a href="structcugip_1_1device__flag__view.html#a9723e55b22d1d553a238db21d4c66702">cugip::device_flag_view::set_device</a></div><div class="ttdeci">CUGIP_DECL_DEVICE void set_device()</div><div class="ttdef"><b>Definition:</b> <a href="device__flag_8hpp_source.html#l00043">device_flag.hpp:43</a></div></div>
<div class="ttc" id="group__meta__algorithm_html_ga5b5057c3753b24eebffa1825efe3d781"><div class="ttname"><a href="group__meta__algorithm.html#ga5b5057c3753b24eebffa1825efe3d781">cugip::for_each</a></div><div class="ttdeci">TFunctor for_each(region&lt; tDimension &gt; aRegion, TFunctor aOperator)</div><div class="ttdef"><b>Definition:</b> <a href="for__each_8hpp_source.html#l00038">for_each.hpp:38</a></div></div>
<div class="ttc" id="structcugip_1_1device__flag_html"><div class="ttname"><a href="structcugip_1_1device__flag.html">cugip::device_flag</a></div><div class="ttdef"><b>Definition:</b> <a href="device__flag_8hpp_source.html#l00080">device_flag.hpp:80</a></div></div>
<div class="ttc" id="defines_8hpp_html_a9467ae046da1c6ac51763cd91fe791d9"><div class="ttname"><a href="defines_8hpp.html#a9467ae046da1c6ac51763cd91fe791d9">CUGIP_DECL_HYBRID</a></div><div class="ttdeci">#define CUGIP_DECL_HYBRID</div><div class="ttdef"><b>Definition:</b> <a href="defines_8hpp_source.html#l00022">defines.hpp:22</a></div></div>
<div class="ttc" id="device__flag_8hpp_html"><div class="ttname"><a href="device__flag_8hpp.html">device_flag.hpp</a></div></div>
<div class="ttc" id="filter_8hpp_html"><div class="ttname"><a href="filter_8hpp.html">filter.hpp</a></div></div>
<div class="ttc" id="structcugip_1_1step1__ftor_html"><div class="ttname"><a href="structcugip_1_1step1__ftor.html">cugip::step1_ftor</a></div><div class="ttdef"><b>Definition:</b> <a href="watershed__transformation_8hpp_source.html#l00094">watershed_transformation.hpp:94</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_259520fd8c10d66b753d6da228310ad1.html">cugip</a></li><li class="navelem"><a class="el" href="dir_4e723222579e3ff6577339876efac82b.html">basic_filters</a></li><li class="navelem"><a class="el" href="watershed__transformation_8hpp.html">watershed_transformation.hpp</a></li>
    <li class="footer">Generated on Fri Feb 17 2017 00:13:08 for CUGIP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
